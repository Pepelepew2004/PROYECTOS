install.packages("pacman")
install.packages("tidyverse")
pacman::p_load(tidyverse, magrittr, janitor,fastDummies)
pacman::p_load(tidyverse, magrittr, janitor,fastDummies, readxl)
data <- readxl::read_xlsx("LQL/Apuntes/Bases/Datos Factor Analysis.xlsx")
View(data)
View(data)
rownames(data) <- data$person
data
?read_xlsx()
?read_excel
rownames(data) <- data$person
dt <- readxl::read_xlsx("LQL/Apuntes/Bases/Datos Factor Analysis.xlsx")
dt
rownames(data) <- data$person
dt <- readxl::read_xlsx("LQL/Apuntes/Bases/Datos Factor Analysis.xlsx") %>%
column_to_rownames(person)
###################################################################################################
#  Creador: José Eduardo Martínez Téllez
#  Fecha: Julio-2022
#   Titulo: Fctr Analysis
#  Descr:
###################################################################################################
pacman::p_load(tidyverse, magrittr, janitor,fastDummies, readxl)
# read_data ---------------------------------------------------------------
dt <- readxl::read_xlsx("LQL/Apuntes/Bases/Datos Factor Analysis.xlsx") %>%
column_to_rownames(person)
dt <- readxl::read_xlsx("LQL/Apuntes/Bases/Datos Factor Analysis.xlsx")
dt
data <- as.data.frame(dt[,2:7])
data
row.names(data) <- t(as.vector(dt[,1]))
data <- as.data.frame(dt[,2:7])
t(as.vector(dt[,1]))
dt[,1]
as.vector(dt[,1])
t(as.vector(dt[,1]))
data
row.names(data) <- t(as.vector(dt[,1]))
t(as.vector(dt[,1]))
t(as.vector(dt[,1]))
t(as.characteras.vector(dt[,1])))
as.characteras.vector(dt[,1]))
as.characteras.vector(dt[,1])))
row.names(data) <- t(as.character(as.vector(dt[,1])))
t(as.character(as.vector(dt[,1])))
row.names(data) <- t(as.vector(as.character(dt[,1])))
as.character(dt[,1])
data <- as.data.frame(dt[,2:7])
data
ev <- eigen(cor(data))
ev
ev$values
pacman::p_load(tidyverse, magrittr, janitor,fastDummies, readxl,
psych)
scree(data, pc=FALSE)
ev$values
scree(data, pc=FALSE)
scree_plot <- data.frame( eigen_values = ev$values)
scree_plot
scree_plot <- data.frame( eigen_values = ev$values, number = seq(1:6))
scree_plot
scree_plot <- data.frame(  number = seq(1:6), eigen_values = ev$values)
scree_plot
dta_scree <- data.frame(  number = seq(1:6), eigen_values = ev$values)
dta_scree %>%
ggplot(aes(x= number, y = eigen_values))+
geom_point()+
geom_line()
dta_scree %>%
ggplot(aes(x= number, y = eigen_values))+
geom_point()+
geom_line() +
theme_minimal()
dta_scree %>%
ggplot(aes(x= number, y = eigen_values))+
geom_point(shape = 1)+
geom_line() +
theme_minimal()
dta_scree %>%
ggplot(aes(x= number, y = eigen_values))+
geom_point(shape = 1)+
geom_line() +
geom_abline( y = 1, shape = 2)+
theme_minimal()
dta_scree %>%
ggplot(aes(x= number, y = eigen_values))+
geom_point(shape = 1)+
geom_line() +
geom_abline(x = 0 y = 1, shape = 2)+
dta_scree %>%
ggplot(aes(x= number, y = eigen_values))+
geom_point(shape = 1)+
geom_line() +
geom_hline(yintercept = 1, shape = 2)+
theme_minimal()
dta_scree %>%
ggplot(aes(x= number, y = eigen_values))+
geom_point(shape = 1)+
geom_line() +
geom_hline(yintercept = 1, color = "red")+
theme_minimal()
?geom_hline
dta_scree %>%
ggplot(aes(x= number, y = eigen_values))+
geom_point(shape = 1)+
geom_line() +
geom_hline(yintercept = 1, color = "red")+
labs(x = "Number of factors", y = "Eigen values")+
theme_minimal()
dta_scree %>%
ggplot(aes(x= number, y = eigen_values))+
geom_point(shape = 1)+
geom_line() +
geom_hline(yintercept = 1, color = "red")+
labs(x = "Number of factors", y = "Eigen values",
title = "Screeplot")+
theme_minimal()
fa_1 <- fa(data,
nfactors = 3,
fm="pa",
max.iter = 100,
rotate = "oblimin")
pacman::p_load(tidyverse, magrittr, janitor,fastDummies, readxl,
psych, GPArotation)
fa_1 <-   fa(
data,
nfactors = 3,
fm = "pa",
max.iter = 100,
rotate = "oblimin"
)
parallel <- fa.parallel(data)
fa_1 <-   fa(
data,
nfactors = 3,
fm = "pa",
max.iter = 100,
rotate = "oblimin"
)
?fa
fa_2 <-   fa(
data,
nfactors = 3,
fm = "pa",
max.iter = 100,
rotate = "varimax"
)
fa_2
fa_1
fa_2
fa.diagram(fa_1)
.diagram(fa_2)
fa.diagram(fa_2)
